(async()=>{let i=null;function e(e=200){return new Promise(t=>{let c=!1;const n=setInterval(async()=>{if(!c){c=!0;var e=await BG.exec("get_settings");if(e.enabled&&e.awscaptcha_auto_solve){e=document.querySelector('input[placeholder="Answer"]');if(e&&""===e.value){var a=function(){try{return document.querySelector("audio").src.replace("data:audio/aac;base64,","")}catch(e){}return null}();if(a&&i!==a)return i=a,clearInterval(n),c=!1,t({input:e,audio_data:a})}c=!1}}},e)})}for(;;){await Time.sleep(1e3);var a,t,c,n,o=await BG.exec("get_settings");if(o&&o.enabled)if(o.awscaptcha_auto_open&&null!==document.querySelector("#captcha-container > #root #amzn-captcha-verify-button")){l=void 0;try{var l=document.querySelector("#captcha-container > #root #amzn-captcha-verify-button");l&&l.click()}catch(e){}await 0}else if(o.hcaptcha_auto_solve&&null!==document.querySelector('#captcha-container > #root #amzn-btn-audio-internal > img[title="Audio problem"]')){l=void 0;try{l=document.querySelector("#captcha-container > #root #amzn-btn-audio-internal");l&&l.click()}catch(e){}await 0}else o.hcaptcha_auto_solve&&null!==document.querySelector('#captcha-container > #root #amzn-btn-audio-internal > img[title="Visual problem"]')&&(t=a=c=n=o=void 0,{input:o,audio_data:n}=await e(),await!(null!==o&&null!==n&&(c=await BG.exec("get_settings")).enabled&&c.awscaptcha_auto_solve&&(a=Time.time(),{job_id:t,data:n}=await NopeCHA.post({captcha_type:IS_DEVELOPMENT?"awscaptcha_dev":"awscaptcha",audio_data:[n],key:c.key}),!n||0===n.length||(0<(c=c.awscaptcha_solve_delay?1e3-(Time.time()-a):0)&&await Time.sleep(c),0===n[0].length)?(document.querySelector("#amzn-btn-refresh-internal")?.click(),await Time.sleep(200),i=null):(o.value=n[0],await Time.sleep(200),document.querySelector("#amzn-btn-verify-internal")?.click()))))}})();
